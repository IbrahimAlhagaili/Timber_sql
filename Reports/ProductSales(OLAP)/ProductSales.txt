SQL> 
SQL> COLUMN category_name FORMAT a15
SQL> COLUMN customer_name FORMAT a15
SQL> COLUMN supplier_name FORMAT a30
SQL> COLUMN quantity_ordered FORMAT 999,999
SQL> COLUMN value_orderd FORMAT $999,999,999.99
SQL> COLUMN product_names FORMAT a150
SQL> --Help with our subquery structure from (Chat GPT 3.5)
SQL> SELECT
  2      category_name,
  3      customer_name,
  4      supplier_name,
  5       --COALESCE SYNTAX from chat gpt 3.5 to display 0 for nulls values for products that have no orders
  6      COALESCE(SUM(quantity_ordered), 0) AS "QUANTITY_ORDERED",
  7      TO_CHAR(COALESCE(SUM(quantity_ordered * price), 0), '$999,999,999.99') AS "VALUE_ORDERD",
  8      -- Help from CHATGPT 3.5 with LISTAGG SYNTAX to display product names for each corresponding row
  9      LISTAGG(product_name, ', ') WITHIN GROUP (ORDER BY product_name) AS "PRODUCT_NAMES"
 10  FROM (
 11      SELECT
 12          Products.product_id,
 13          Category.category_name,
 14          ProductSupplierBridge.supplier_id,
 15          Suppliers.supplier_name,
 16          Orders.quantity_ordered,
 17          Customers.first_name || ' ' || Customers.last_name AS "CUSTOMER_NAME",
 18          Products.price,
 19          Products.product_name
 20      FROM
 21          Products
 22      JOIN
 23          Category ON Products.category_id = Category.category_id
 24      JOIN
 25          ProductSupplierBridge ON Products.product_id = ProductSupplierBridge.product_id
 26      JOIN
 27          Suppliers ON ProductSupplierBridge.supplier_id = Suppliers.supplier_id
 28      --Help with left join syntax from chatgpt to include products that dont have any orders
 29      LEFT JOIN
 30          OrderProductBridge ON Products.product_id = OrderProductBridge.product_id
 31      LEFT JOIN
 32          Orders ON OrderProductBridge.order_id = Orders.order_id
 33      LEFT JOIN
 34          Customers ON Orders.customer_id = Customers.customer_id
 35  ) subquery
 36  GROUP BY
 37      ROLLUP(category_name, customer_name, supplier_name)
 38  ORDER BY
 39      category_name, customer_name, supplier_name;

CATEGORY_NAME   CUSTOMER_NAME   SUPPLIER_NAME                  QUANTITY_ORDERED VALUE_ORDERD     PRODUCT_NAMES                                                                                                                                                                                                                                                                                                                                                                                                      
--------------- --------------- ------------------------------ ---------------- ---------------- ------------------------------------------------------------------------------------------------------------------------------------------------------                                                                                                                                                                                                                                                             
Books           Bob Smith       Toy Universe                                  3          $189.97 Childrens Books Set, Cookbook Collection                                                                                                                                                                                                                                                                                                                                                                           
Books           Bob Smith                                                     3          $189.97 Childrens Books Set, Cookbook Collection                                                                                                                                                                                                                                                                                                                                                                           
Books           Charlie Brown   Toy Universe                                  2          $159.98 Novel Collection                                                                                                                                                                                                                                                                                                                                                                                                   
Books           Charlie Brown                                                 2          $159.98 Novel Collection                                                                                                                                                                                                                                                                                                                                                                                                   
Books                                                                         5          $349.95 Childrens Books Set, Cookbook Collection, Novel Collection                                                                                                                                                                                                                                                                                                                                                         
Clothing                        Toy Universe                                  0             $.00 Leather Wallet                                                                                                                                                                                                                                                                                                                                                                                                     
Clothing                                                                      0             $.00 Leather Wallet                                                                                                                                                                                                                                                                                                                                                                                                     
Clothing        Alice Johnson   Fashion Emporium                              2          $159.98 Designer Jeans                                                                                                                                                                                                                                                                                                                                                                                                     
Clothing        Alice Johnson                                                 2          $159.98 Designer Jeans                                                                                                                                                                                                                                                                                                                                                                                                     
Clothing        Bob Smith       Toy Universe                                  3          $389.97 Wristwatch Classic                                                                                                                                                                                                                                                                                                                                                                                                 
Clothing        Bob Smith                                                     3          $389.97 Wristwatch Classic                                                                                                                                                                                                                                                                                                                                                                                                 
Clothing        David Lee       Fashion Emporium                              2          $179.98 Running Shoes                                                                                                                                                                                                                                                                                                                                                                                                      
Clothing        David Lee                                                     2          $179.98 Running Shoes                                                                                                                                                                                                                                                                                                                                                                                                      
Clothing                                                                      7          $729.93 Designer Jeans, Leather Wallet, Running Shoes, Wristwatch Classic                                                                                                                                                                                                                                                                                                                                                  
Electronics                     Electronics Superstore                        0             $.00 Digital Camera                                                                                                                                                                                                                                                                                                                                                                                                     
Electronics                                                                   0             $.00 Digital Camera                                                                                                                                                                                                                                                                                                                                                                                                     
Electronics     Alice Johnson   Electronics Superstore                        6        $1,049.94 Headphones X, Smartwatch Pro                                                                                                                                                                                                                                                                                                                                                                                       
Electronics     Alice Johnson   Fashion Emporium                              3          $449.97 Headphones X                                                                                                                                                                                                                                                                                                                                                                                                       
Electronics     Alice Johnson   Toy Universe                                  3          $599.97 Smartwatch Pro                                                                                                                                                                                                                                                                                                                                                                                                     
Electronics     Alice Johnson                                                12        $2,099.88 Headphones X, Headphones X, Smartwatch Pro, Smartwatch Pro                                                                                                                                                                                                                                                                                                                                                         
Electronics     Bob Smith       Electronics Superstore                        2          $119.98 Bluetooth Speaker                                                                                                                                                                                                                                                                                                                                                                                                  
Electronics     Bob Smith                                                     2          $119.98 Bluetooth Speaker                                                                                                                                                                                                                                                                                                                                                                                                  
Electronics     Charlie Brown   Toy Universe                                  5          $149.95 Wireless Mouse                                                                                                                                                                                                                                                                                                                                                                                                     
Electronics     Charlie Brown                                                 5          $149.95 Wireless Mouse                                                                                                                                                                                                                                                                                                                                                                                                     
Electronics                                                                  19        $2,369.81 Bluetooth Speaker, Digital Camera, Headphones X, Headphones X, Smartwatch Pro, Smartwatch Pro, Wireless Mouse                                                                                                                                                                                                                                                                                                      
Home And Garden                 Electronics Superstore                        0             $.00 Coffee Maker                                                                                                                                                                                                                                                                                                                                                                                                       
Home And Garden                 Toy Universe                                  0             $.00 Desk Lamp                                                                                                                                                                                                                                                                                                                                                                                                          
Home And Garden                                                               0             $.00 Coffee Maker, Desk Lamp                                                                                                                                                                                                                                                                                                                                                                                            
Home And Garden Alice Johnson   Garden Retreat                                2          $399.98 Garden Table                                                                                                                                                                                                                                                                                                                                                                                                       
Home And Garden Alice Johnson                                                 2          $399.98 Garden Table                                                                                                                                                                                                                                                                                                                                                                                                       
Home And Garden Charlie Brown   Garden Retreat                                4          $999.96 Outdoor Grill                                                                                                                                                                                                                                                                                                                                                                                                      
Home And Garden Charlie Brown   Toy Universe                                  4        $2,799.96 Sofa Set                                                                                                                                                                                                                                                                                                                                                                                                           
Home And Garden Charlie Brown                                                 8        $3,799.92 Outdoor Grill, Sofa Set                                                                                                                                                                                                                                                                                                                                                                                            
Home And Garden                                                              10        $4,199.90 Coffee Maker, Desk Lamp, Garden Table, Outdoor Grill, Sofa Set                                                                                                                                                                                                                                                                                                                                                     
Toys                            Toy Universe                                  0             $.00 Tennis Racket                                                                                                                                                                                                                                                                                                                                                                                                      
Toys                                                                          0             $.00 Tennis Racket                                                                                                                                                                                                                                                                                                                                                                                                      
Toys            Charlie Brown   Toy Universe                                  2          $599.98 Dining Table                                                                                                                                                                                                                                                                                                                                                                                                       
Toys            Charlie Brown                                                 2          $599.98 Dining Table                                                                                                                                                                                                                                                                                                                                                                                                       
Toys                                                                          2          $599.98 Dining Table, Tennis Racket                                                                                                                                                                                                                                                                                                                                                                                        
                                                                             43        $8,249.57 Bluetooth Speaker, Childrens Books Set, Coffee Maker, Cookbook Collection, Designer Jeans, Desk Lamp, Digital Camera, Dining Table, Garden Table, Head                                                                                                                                                                                                                                                             
                                                                                                 phones X, Headphones X, Leather Wallet, Novel Collection, Outdoor Grill, Running Shoes, Smartwatch Pro, Smartwatch Pro, Sofa Set, Tennis Racket, Wirel                                                                                                                                                                                                                                                             
                                                                                                 ess Mouse, Wristwatch Classic                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    

40 rows selected.

SQL> 
SQL> SPOOL OFF
